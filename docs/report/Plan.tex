\section{はじめに}
\subsection{背景}
近年、3Dプリンタ、プロジェクションマッピングやバーチャルリアリティ技術の普及より、コンピュータグラフィックス(CG)は重要な技術になっている。
これらの3D技術が身近になることで、現実世界に近いリアルな画像やアニメーションの作成技術もさらに重要になると予想される。 CGの研究においては水の表現のような流体シミュレーションに関する研究が盛んに行われているが水の特徴である三態変化を扱う研究はほとんど行われていない。
特に水が液体から気体へ相転移する際に発生する、湯気の表現手法は確立していない。
湯気の表現がCGにより可能になることで、従来のCGでは作成できない湯気が発生する温泉、暖かい料理といったシーンを表現可能となり、よりCGの表現能力を上げることができると考えられる。
これより本研究ではCGによるフォトリアルな湯気のシミュレーションを行うことを目的とする。
\subsection{関連研究}
湯気の発生に関する表現に特化したCGによる流体シミュレーションの研究は行われていない。
湯気に近い表現としては煙\cite{Fedkiw2001}、雲\cite{Dobashi2000}\cite{Miyazaki2001}\cite{Miyazaki2002}、火山噴煙\cite{Mizuno2003}\cite{Mizuno2004}、水煙\cite{Nielsen2013}のシミュレーションの研究がある。
水の蒸発、凝固、凝結といった性質を包括的に扱う研究\cite{Fujisawa2008}はあるが湯気に関しては考慮されない。
\cite{Foster1997}では湯気(Steam)の表現の言及はあるが水蒸気量を考慮した表現は行われていない。
流体力学では複数の相が混じり合う物質は混相流(multi phase flow)、湯気のように気体と液体が混合する物体の動きは気液二相流として研究が行われているがCGの作成を目的とはしていない。

実用的なCGによる流体シミュレーションはStamによるStableFluid法\cite{Stam1999}により行われた。
これは格子法による差分化を行い、移流項をバックトレースすることにより解くセミラグランジュ法を取り入れた手法で大きな時間幅でも安定的である。
この手法は煙\cite{Fedkiw2001}、水\cite{Foster2001}、火\cite{Nguyen2002}、爆発\cite{Feldman2003}のようなCGによる流体シミュレーションの基礎となった。

StableFluid法は一次の精度のため数値拡散が強く現れる。
Kimら\cite{Kim2005}はBFECC法により高精度な移流を提案した。
BFECC法はバックトレース時にフォワードトレースにより求めた誤差を修正することで	高精度に移流を行う方法である。
Selleら\cite{Selle2008}はMacCormack法によりBFECC法のコストを減らした。
ZhuとBridson\cite{Zhu2005}は格子法とパーティクル法の両方を用いたFLIP法によりさらに数値拡散を減らした。



\subsection{湯気の発生原理と特徴}
湯気は水蒸気が温度の低い場所で冷えて凝結し、水滴となって白くなったものである。湯気は水蒸気が外気と触れた際に温度が低下し、水蒸気量が飽和水蒸気量を上回った場合、大気中の細かい塵を核として凝結することで発生する。この際、発生する湯気の粒子は光の波長と同程度、もしくは少し大きめの大きさとなり、どの光の波長も均等に散乱されるミー散乱という現象が起こり白く見える。発生した湯気は空気よりも軽いことにより浮力が発生して上昇し、やがて空気中に蒸発して消滅する。

湯気の特徴を湯気に似た動きを持つ煙との対比により説明する。まず湯気は水蒸気が液体に変化してから蒸発するため、可視化できる時間が一時的で温度や湿度による条件の違いによって発生の仕方が異なる。また映像として利用されるシーンを想定すると飲み物や風呂など湯気の発生元としては液体のように流動性を持ったもので、湯気が発生元の物体の表面温度も一様ではないことから、物体から不規則に湯気が発生する。細かい点では湯気の粒子の大きさは10〜100umと言われており条件によっては人間の肉眼でも粒子を確認することが可能である。
本研究ではこれらの湯気の特徴を元に湯気のモデル化を行う。

\subsection{湯気のモデル化とシミュレーション}
CGによる湯気のシミュレーションは既存のCGの表現方法を組み合わせる方針とする。具体的には流れのモデリングは煙をベースとし、湯気の発生と消滅のモデリングは雲の表現をベースとする。

流れのモデリングは\cite{Stam1999}\cite{Fedkiw2001}の手法を用いる。この手法では流体の支配方程式としてナビエストークス方程式、連続の式を用いる。また流体シミュレーションの手法としては空間をグリッドで分割するデータ構造を用いる格子法を用いるが、この場合、数値拡散により小さな渦が消えてしまうため渦を追加する渦度強制法(vorticity confinement)という手法を用いる。

湯気の発生と消滅のモデリングは\cite{Miyazaki2002}の手法を参考とする。これは大気流体をモデルとして雲の生成モデルを偏微分方程式により定義している。湯気の生成は雲とはスケールが異なるが基本的なメカニズムは変わらないため、雲と同様のモデルを採用する。ただし環境温度が空間の高さにより低下するなど大気特有の変数についてはモデルから削除する。
湯気の発生元のシミュレーションは、\cite{Miyazaki2001}の手法を参考として湯気発生元の表面からランダム性を持つ濃度の水蒸気を追加する。この際、CGにおいてランダムで自然な地形の生成等に利用するノイズであるパーリンノイズを利用する。これにより水などの液体から湯気発生する場合の不規則な湯気の表現、料理のように温度分布が一様でない物体からの湯気の表現が可能になると考えられる。

\subsection{評価方法}
本研究は過去の研究事例が無い状況であるため過去事例との比較が困難となっている。
CGは映画などの映像に利用されることを目的としているため、見た目として正しく表現されていることが求められ、必ずしも物理的に正しいことは求められない。
そのためCGにおいて新規の表現手法を提案する場合の評価として定性的なものとなり定量的な測定は困難である。

実際の研究事例から新規の表現手法にどのような評価手法が取られているかを確認した。
CGにおいて初めて水\cite{Foster1996}や雲\cite{Gardner1985}がシミュレートされた例では出力された絵とその説明のみとなっている。
火山噴煙\cite{Mizuno2003}やプロミネンス\cite{Ishikawa}が初めてシュミレートされた場合は実際の写真と出力された絵を並べることにより比較を行っている。

上記より評価の手法としては定量的な評価ではなく、出力された絵の説明を行い、可能であれば実際の写真との比較により行うこととする。

\subsection{発展的研究}
計画に記載した湯気のモデル化手法は10年以上前の古典的な手法を組み合わせ、改変したものである。現在では湯気に関連のある新たな手法があり、これらを利用することでよりリアリティのある表現が可能となることが考えられる。湯気の発生源のシミュレーションと煙の乱流のシミュレーションで用いる渦度強制法(Vorticity Confinement)にウェーブレットノイズを用いた手法\cite{Kim2008}を利用することでリアルな湯気の発生と高解像度な乱流を生成することができる。また湯気の発生と消滅のモデルは雲のモデルの利用を予定しており、スケールが異なるため十分な結果を得られない可能性がある。そのため流体力学の混相流のシミュレーションの分野で用いられる手法を取り入れることも考えられる。例えば、\cite{Mizuno2003}では火山噴煙のシミュレーションに２流体モデルを利用している。水滴の表現としては水煙の表現で用いられる手法\cite{Nielsen2013}の利用が検討できる。
また湯気の発生箇所としては水分が含まれる液体状の流体であるシーンが多い。
液体状の流体から発生する湯気をシミュレートすることにより、さらに表現力を高められると考えられる。
湯気の発生元のシミュレーションはパーリンノイズを利用することを想定しているが、柔軟に流体を表現することができるFLIP法\cite{Zhu2005}を用いることも検討したい。

湯気の表現としては現実を再現した場合に必ずしも効果的な湯気の表現とならない。例えば、CGを利用せずに湯気を含む写真の撮影する際、ドライアイス等で外気の温度を下げることで効果的な湯気を生成する技法がある。このように効果的な湯気を生成するためにユーザが自由に湯気をデザインできるモデリングツールの開発が応用例として考えられる。
また、GPUを利用した高速化・リアルタイム化、バーチャルリアリティ技術への適用、湯気だけでなく物体へのしみ込みや凝結といった水のさらなる表現力の向上に取り組むことも考えられる。

\subsection{スケジュール}
現状は流体力学の深い理解、流体シミュレーションの実装の経験はない。そのため既存のソフトウエア、ソースの利用は行わず、スクラッチからの流体シミュレーションからの実装を行う方針とする。湯気の流れは煙の表現をベースに検討しているためVisual Simulation of Smoke[1]の実装を行う(8月)。この際、データ構造はやや異なるがStable Fluids[14]によるシンプルなソース、研究者により公開される流体シミュレーションのソースを参考とする。その後、湯気の動きの物理モデルを雲のモデルをベースとして作成し(9月)、作成したモデルをベースに実装を行う(10月)。さらに湯気の発生源のシミュレーションを行い(11月)、その後パラメータの見直し等の改良を行う(12月)。
利用する言語、ツール、フレームワークとしては物理シミュレーションの計算部分はC/C++、レンダリング部分は外部のレンダリングソフトウエア(POV-Ray,PBRT等)を用いる。また簡易的なモデルの表示確認にはOpenGLを用いることとする。また関連研究とともに公開されるソースサンプルは必要に応じて活用を検討する。
上記作業を修士課程中に行うこととする。括弧内のスケジュールはベストケースのスケジュールとして記載したものであり、進捗により随時スケジュールは見直す。もし括弧内のスケジュール通りに完了した場合は、以下に記載したさらに発展的な研究に取り組むこととする。

